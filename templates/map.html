{% extends "master.html" %}


{% block title %}Send Coords, get Map!{% endblock %}
{% block body %}

<div id="map"></div>

{% endblock %}

{% block script %}
<script type="text/javascript">
var CenterLatLng = { lat: {{ photos[0]['lat'] }} , lng: {{ photos[0]['lng'] }} };
var map;
var markers=[];

function initMap(){
  map = new google.maps.Map(document.getElementById('map'),{
    center: CenterLatLng,
    zoom:12
  });
  addMarkers();
}
function addMarkers(){
  var markerLatLng;
  {% for photo in photos %}
  console.log("{{photo}}")
  markerLatLng = { lat : {{ photo['lat'] }} , lng : {{ photo['lng'] }} };
  markers.push(new google.maps.Marker({
    position:markerLatLng,
    map:map,
    title:"{{ photo['title'] }}",
    animation:google.maps.Animation.DROP
  }));
  {% endfor %}
  var bounds = new google.maps.LatLngBounds();
  for(i = 0; i < markers.length; i++){
    bounds.extend(markers[i].getPosition());
  }
  map.fitBounds(bounds);
}
</script>

<script async defer src ="https://maps.googleapis.com/maps/api/js?key={{gKey}}&callback=initMap"></script>
{% endblock %}
